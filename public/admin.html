<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Admin - Dairy</title>
  </head>
  <body>
    <h1>Admin</h1>
    <h2>Add Partner</h2>
    <form id="partnerForm">
      <input name="name" placeholder="Name" required />
      <input name="phone" placeholder="Phone" required />
      <button>Add Partner</button>
    </form>

    <h2>Schedule Delivery</h2>
    <form id="deliveryForm">
      <input name="date" type="date" required />
      <input name="address" placeholder="Address" required />
      <input name="liters" type="number" step="0.1" required />
      <input name="partnerId" placeholder="Partner ID (optional)" />
      <input name="customerId" placeholder="Customer ID (optional)" />
      <button>Schedule</button>
    </form>

    <div id="result"></div>

    <script>
    const api = (path, opts) => fetch(path, opts).then(r=>r.json());
    document.getElementById('partnerForm').addEventListener('submit', e=>{
      e.preventDefault();
      const fd = new FormData(e.target);
      api('/api/admin/partner', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({name: fd.get('name'), phone: fd.get('phone')}) })
      .then(r=> document.getElementById('result').innerText = JSON.stringify(r, null, 2))
    });

    document.getElementById('deliveryForm').addEventListener('submit', e=>{
      e.preventDefault();
      const fd = new FormData(e.target);
      api('/api/admin/delivery', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({date: fd.get('date'), address: fd.get('address'), liters: parseFloat(fd.get('liters')), partnerId: fd.get('partnerId') || null, customerId: fd.get('customerId') || null}) })
      .then(r=> document.getElementById('result').innerText = JSON.stringify(r, null, 2))
    });
    </script>
  </body>
  </html>
